<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2024-12-31T13:48:00.000Z" agent="Kiro" version="22.1.0">
    <diagram id="key-hierarchy-updated" name="Key Hierarchy Updated">
        <mxGraphModel dx="1054" dy="542" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1200" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="title" value="SUNBAY MPoC SDK å¯†é’¥å±‚æ¬¡ç»“æž„ä¸Žå­˜å‚¨ä½ç½® (v2.2)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=22;fontStyle=1;fontColor=#FF6000;" parent="1" vertex="1">
                    <mxGeometry x="300" y="20" width="1000" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="subtitle" value="è¯ä¹¦è®¤è¯ (å…±åŒå‰æ) + åŸºäºŽ TEE ç±»åž‹çš„åˆ†å±‚å¯†é’¥ç®¡ç†" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;fontSize=14;fontStyle=2;fontColor=#666;" parent="1" vertex="1">
                    <mxGeometry x="450" y="60" width="700" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="cert-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#E65100;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="50" y="100" width="1400" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="cert-title" value="ðŸ“œ è¯ä¹¦å±‚ (Certificate Layer) - æ‰€æœ‰æ¨¡å¼çš„å…±åŒå‰æ" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=18;fontStyle=1;fontColor=#E65100;" parent="1" vertex="1">
                    <mxGeometry x="550" y="115" width="500" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="root-ca" value="ðŸ” SUNBAY Root CA&#10;(è‡ªç­¾å, 10å¹´æœ‰æ•ˆæœŸ)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#FFA000;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="100" y="150" width="150" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="int-ca" value="ðŸ” SUNBAY MPoC&#10;Intermediate CA&#10;(5å¹´æœ‰æ•ˆæœŸ)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#FFA000;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="300" y="150" width="150" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="device-cert" value="ðŸ“± Device Certificate&#10;(1å¹´æœ‰æ•ˆæœŸ, å¯ç»­æœŸ)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="500" y="150" width="150" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="device-key" value="ðŸ”‘ è®¾å¤‡ ECC ç§é’¥&#10;(P-256, Android Keystore)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="700" y="150" width="150" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="arrow-root-int" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#FFA000;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="250" y="175" as="sourcePoint"/>
                        <mxPoint x="300" y="175" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-int-device" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#1976D2;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="450" y="175" as="sourcePoint"/>
                        <mxPoint x="500" y="175" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-cert-key" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#1976D2;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="650" y="175" as="sourcePoint"/>
                        <mxPoint x="700" y="175" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="cert-usage" value="ç”¨é€”: èº«ä»½è®¤è¯ã€è¯·æ±‚ç­¾åã€å¯†é’¥äº¤æ¢è®¤è¯" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=12;fontStyle=2;fontColor=#E65100;" parent="1" vertex="1">
                    <mxGeometry x="900" y="165" width="300" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="tee-decision" value="TEE ç±»åž‹æ£€æµ‹" style="rhombus;whiteSpace=wrap;html=1;fillColor=#FFE0B2;strokeColor=#FF6000;fontSize=14;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="650" y="250" width="200" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#388E3C;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="50" y="350" width="600" height="400" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-title" value="ðŸ”’ DUKPT æ¨¡å¼ (SE/TEE è®¾å¤‡)" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=18;fontStyle=1;fontColor=#388E3C;" parent="1" vertex="1">
                    <mxGeometry x="200" y="365" width="300" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-security" value="â­â­â­ æœ€é«˜å®‰å…¨çº§åˆ«" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=12;fontStyle=1;fontColor=#2E7D32;" parent="1" vertex="1">
                    <mxGeometry x="250" y="395" width="200" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-bdk" value="ðŸ” BDK&#10;(Base Derivation Key)&#10;HSM ç®¡ç†" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#FFA000;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="80" y="430" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-ipek" value="ðŸ”‘ IPEK&#10;(Initial PIN Encryption Key)&#10;TEE/SE å­˜å‚¨" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#388E3C;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="240" y="430" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-txn-key" value="ðŸ”’ Transaction Key&#10;(æ¯ç¬”äº¤æ˜“å”¯ä¸€)&#10;åŠ¨æ€æ´¾ç”Ÿ" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4CAF50;strokeColor=#1B5E20;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="420" y="430" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="arrow-bdk-ipek" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#388E3C;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="200" y="460" as="sourcePoint"/>
                        <mxPoint x="240" y="460" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-ipek-txn" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#388E3C;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="380" y="460" as="sourcePoint"/>
                        <mxPoint x="420" y="460" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="dukpt-ksn-title" value="KSN (Key Serial Number) æ ¼å¼" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=14;fontStyle=1;fontColor=#388E3C;" parent="1" vertex="1">
                    <mxGeometry x="200" y="520" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-ksn" value="FFFF 9876543210 E00001&#10;â”‚    â”‚          â”‚&#10;â”‚    â”‚          â””â”€â”€ äº¤æ˜“è®¡æ•°å™¨ (21 bits)&#10;â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è®¾å¤‡æ ‡è¯† (59 bits)&#10;â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¯†é’¥é›† ID (4 bits)" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=11;fontFamily=monospace;fillColor=#E8F5E9;strokeColor=#388E3C;" parent="1" vertex="1">
                    <mxGeometry x="80" y="550" width="480" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-storage-title" value="å­˜å‚¨ä½ç½®" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=14;fontStyle=1;fontColor=#388E3C;" parent="1" vertex="1">
                    <mxGeometry x="200" y="650" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-se-storage" value="ðŸ”’ SE èŠ¯ç‰‡å†…&#10;(ç‹¬ç«‹å®‰å…¨èŠ¯ç‰‡)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DCEDC8;strokeColor=#689F38;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="80" y="680" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-tee-storage" value="ðŸ”’ TEE å®‰å…¨åŒº&#10;(ARM TrustZone)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DCEDC8;strokeColor=#689F38;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="240" y="680" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="dukpt-warning" value="âš ï¸ ä¸èƒ½å­˜å‚¨åˆ°&#10;Android Keystore" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#C62828;strokeWidth=2;fontSize=11;fontStyle=1;fontColor=#C62828;" parent="1" vertex="1">
                    <mxGeometry x="400" y="680" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="whitebox-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FCE4EC;strokeColor=#C2185B;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="700" y="350" width="600" height="400" as="geometry"/>
                </mxCell>
                <mxCell id="whitebox-title" value="ðŸ›¡ï¸ WhiteBox DH-ECC æ¨¡å¼" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=18;fontStyle=1;fontColor=#C2185B;" parent="1" vertex="1">
                    <mxGeometry x="850" y="365" width="300" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="whitebox-security" value="â­ ä¸­ç­‰å®‰å…¨çº§åˆ«" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=12;fontStyle=1;fontColor=#AD1457;" parent="1" vertex="1">
                    <mxGeometry x="900" y="395" width="200" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="wb-device-key" value="ðŸ”‘ è®¾å¤‡ ECC å¯†é’¥å¯¹&#10;(P-256)&#10;Android Keystore" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="730" y="430" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="wb-ephemeral-key" value="ðŸ”„ ä¸´æ—¶ ECDH å¯†é’¥å¯¹&#10;(å•æ¬¡ä½¿ç”¨)&#10;å†…å­˜ (ç”¨åŽé”€æ¯)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#E65100;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="900" y="430" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="wb-session-key" value="ðŸ”’ AES-256 ä¼šè¯å¯†é’¥&#10;(30åˆ†é’Ÿæœ‰æ•ˆ)&#10;WhiteBox ä¿æŠ¤å†…å­˜" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FCE4EC;strokeColor=#C2185B;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="1070" y="430" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="arrow-wb-device-ephemeral" value="ç­¾åè®¤è¯" style="endArrow=classic;html=1;rounded=0;strokeColor=#E65100;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="870" y="460" as="sourcePoint"/>
                        <mxPoint x="900" y="460" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-wb-ephemeral-session" value="ECDH + HKDF" style="endArrow=classic;html=1;rounded=0;strokeColor=#C2185B;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1040" y="460" as="sourcePoint"/>
                        <mxPoint x="1070" y="460" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="wb-lifecycle-title" value="ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=14;fontStyle=1;fontColor=#C2185B;" parent="1" vertex="1">
                    <mxGeometry x="850" y="520" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="wb-lifecycle" value="â€¢ ä¼šè¯æœ‰æ•ˆæœŸ: 30 åˆ†é’Ÿ&#10;â€¢ æœ€å¤§äº¤æ˜“æ•°: 100 ç¬”&#10;â€¢ è‡ªåŠ¨ç»­æœŸ: è¿‡æœŸå‰ 5 åˆ†é’Ÿ&#10;â€¢ å¯†é’¥æ´¾ç”Ÿ: HKDF-SHA256&#10;â€¢ åŠ å¯†ç®—æ³•: AES-256-GCM" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=11;" parent="1" vertex="1">
                    <mxGeometry x="730" y="550" width="480" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="wb-storage-title" value="å­˜å‚¨ä½ç½®" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=14;fontStyle=1;fontColor=#C2185B;" parent="1" vertex="1">
                    <mxGeometry x="850" y="650" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="wb-keystore" value="ðŸ” Android Keystore&#10;(è®¾å¤‡è¯ä¹¦+ç§é’¥)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="730" y="680" width="140" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="wb-memory" value="ðŸ’¾ å†…å­˜&#10;(ä¸´æ—¶å¯†é’¥å¯¹)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#E65100;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="900" y="680" width="140" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="wb-protected" value="ðŸ›¡ï¸ WhiteBox ä¿æŠ¤å†…å­˜&#10;(ä¼šè¯å¯†é’¥)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FCE4EC;strokeColor=#C2185B;strokeWidth=2;fontSize=11;fontStyle=1;" parent="1" vertex="1">
                    <mxGeometry x="1070" y="680" width="140" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="arrow-tee-dukpt" value="SE/TEE" style="endArrow=classic;html=1;rounded=0;strokeColor=#388E3C;strokeWidth=3;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="650" y="280" as="sourcePoint"/>
                        <mxPoint x="350" y="350" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-tee-whitebox" value="WhiteBox" style="endArrow=classic;html=1;rounded=0;strokeColor=#C2185B;strokeWidth=3;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="850" y="280" as="sourcePoint"/>
                        <mxPoint x="1000" y="350" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-cert-tee" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#FF6000;strokeWidth=3;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="750" y="220" as="sourcePoint"/>
                        <mxPoint x="750" y="250" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="summary-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FAFAFA;strokeColor=#9E9E9E;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="50" y="780" width="1250" height="170" as="geometry"/>
                </mxCell>
                <mxCell id="summary-title" value="ðŸ“Š å¯†é’¥å­˜å‚¨ä½ç½®æ€»ç»“" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=16;fontStyle=1;fontColor=#333;" parent="1" vertex="1">
                    <mxGeometry x="550" y="795" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="summary-table" value="å¯†é’¥/è¯ä¹¦ç±»åž‹ | SE æ¨¡å¼ | TEE æ¨¡å¼ | WhiteBox æ¨¡å¼&#10;è®¾å¤‡è¯ä¹¦ | Android Keystore | Android Keystore | Android Keystore&#10;è®¾å¤‡ç§é’¥ | Android Keystore | Android Keystore | Android Keystore&#10;DUKPT IPEK | SE èŠ¯ç‰‡å†… | TEE å®‰å…¨åŒº | âŒ ä¸é€‚ç”¨&#10;ä¼šè¯å¯†é’¥ | âŒ ä¸é€‚ç”¨ | âŒ ä¸é€‚ç”¨ | WhiteBox ä¿æŠ¤å†…å­˜" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=12;fontFamily=monospace;" parent="1" vertex="1">
                    <mxGeometry x="70" y="830" width="1210" height="60" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>